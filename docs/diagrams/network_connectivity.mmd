flowchart TD
    Desc["ğŸŒ NetvÃ¦rk â€” hvordan hÃ¥ndteres manglende forbindelse?\nAppen overvÃ¥ger konstant om der er internet. NÃ¥r forbindelsen\nforsvinder, sendes brugeren til en dedikeret 'Ingen forbindelse'-side.\nNÃ¥r forbindelsen vender tilbage, kan brugeren prÃ¸ve igen og\ngÃ¥ tilbage til hvor de var."]
    style Desc fill:#e8f4fd,stroke:#b8d4e8

    subgraph Guard ["OvervÃ¥gning af forbindelse"]
        InitState["Ved app-start: Tilmeld dig netvÃ¦rksÃ¦ndringer\n+ tjek forbindelse hvert 15. sekund"]
        Listen["Lyt pÃ¥ connectivity_plus:\nhar brugeren mistet\nWiFi/mobil data?"]
        Poll["Hvert 15. sekund:\nForsÃ¸g at forbinde\ntil Supabase-server"]
        Listen -->|"Ja â€” ingen forbindelse"| MarkOffline["Gem at vi er offline\nog gem nuvÃ¦rende side\n(til senere tilbagevenden)"]
        Poll -->|"Kunne ikke forbinde"| MarkOffline
        MarkOffline --> Redirect["Send bruger til\n'Ingen forbindelse'-side"]
    end

    subgraph NoConnection ["Bruger ser 'Ingen forbindelse'-side"]
        ShowScreen["Vis besked om\nmanglende internet"]
        TryAgain["Bruger kan trykke\n'PrÃ¸v igen'"]
        ListenStream["Appen lytter selv:\nkom forbindelsen tilbage?"]
        ListenStream -->|"Ja â€” WiFi/data tilbage"| Reconnect["ForsÃ¸g at forbinde\ntil Supabase-server"]
        TryAgain --> Reconnect
        Reconnect -->|"Forbindelse OK"| ClearOffline["MarkÃ©r at vi er online igen"]
        ClearOffline --> GoBack["Send bruger tilbage til\nden side de var pÃ¥\neller til start"]
    end
